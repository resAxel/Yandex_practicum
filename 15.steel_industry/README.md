# Оптимизация производственных расходов электроэнергии на этапе обработки стали

**Заказчик:** металлургический комбинат ООО «Так закаляем сталь».\
**Цель проекта:** уменьшить потребление электроэнергии на этапе обработки стали.\
**Решение:** построить модель, которая предскажет температуру стали.

## Данные

Данные состоят из файлов, полученных из разных источников:

- `data_arc.csv` — данные об электродах;
- `data_bulk.csv` — данные о подаче сыпучих материалов (объём);
- `data_bulk_time.csv` *—* данные о подаче сыпучих материалов (время);
- `data_gas.csv` — данные о продувке сплава газом;
- `data_temp.csv` — результаты измерения температуры;
- `data_wire.csv` — данные о проволочных материалах (объём);
- `data_wire_time.csv` — данные о проволочных материалах (время).

Во всех файлах столбец `key` содержит номер партии. В файлах может быть несколько строк с одинаковым значением `key`: они соответствуют разным итерациям обработки.

## Задачи
1. *Подготовка данных для обучения.*\
Убрать аномальные значения из данных.\
Подготовить датасет с соответсвующими признаками.\
Проверить признаки на мультиколлинеарность.
2. *Обучить модели.*\
Разделить данные на тренировочную и обучающую выборки.\
Подобрать гиперпараметры модели для минимизации метрики.
3. *Проанализировать модели.*\
Проверить модели на адекватность.\
Проанализировать важность признаков.
4. *Сделать выводы по проекту.* 

## Используемые библиотеки
*pandas*  
*sklearn*  
*matplotlib*

## Статус проекта
Завершен

## Ключевой вывод/результат
При подготовке данных для обучения особое внимание уделялось адекватности значений измеряемых парамтров. Поэтому пропуски и аномальные значения не восстанавливались а удалялись всмести с остальными значениями относящимися к этой партии. Так же проверялась последовательность получения данных согласно временным меткам.

При составлении набора признаков для обучения модели из исходых данных были выделены начальная и конечная температура, затраченнуая энергия, газ и набор примесей. Целевой признак - конечная температура.

По исходным данным было видно что некоторые примеси используются значительно реже других. И как потом показал анализ важности признаков обученной модели они практически не плияют на результат предсказания. Т.е. модель может быть оптимизирована сокращением количества признаков.

Для проверки на мультиколлинеарность использовались 6 основных признаков. В качестве примесей использовались 'Wire 1'и 'Bulk 4'. Корреляционный анализ не показал явных зависимостей.

В качестве моделей были выбраны линейная регрессия и случайный реграссионный лес. Для случайного регрессионного леса использовался подбор гиперпараметров с применение кроссвалидации. Обе модели показали результат на тестовой выборке удовлетворяющий максимальные требования тимлида MAE<6. Обе модели прошли проверку на адекватность сравенением с константной медианной моделью.

В итоге можно остановится на модели линейная регрессия по двум причинам: 1) она показывает лучший результат на тестовой выборке; 2)нет необходимости подбирать гиперпараметры при обучении а следовательно проще переобучать при изменении техпроцесса.

Анализ признаков показал, что самым важным фактором является первая температура. Управляя ею, мы сможем управлять энергозатратами.
